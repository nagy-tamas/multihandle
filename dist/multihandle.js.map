{"version":3,"sources":["../src/multihandle.js"],"names":[],"mappings":";;;;;;AAAA,CAAC,UAAC,MAAD,EAAY;AACX,MAAM,QAAQ,IAAd;;AADW,MAGL,WAHK;AAIT,yBAAY,EAAZ,EAA8B;AAAA,UAAd,OAAc,yDAAJ,EAAI;;AAAA;;AAC5B,WAAK,EAAL,GAAU,EAAV;;AAEA;AACA,WAAK,EAAL,CAAQ,SAAR,GAAoB,GAAG,SAAH,CAAa,OAAb,CAAqB,uBAArB,EAA8C,EAA9C,CAApB;;AAEA;AACA,WAAK,OAAL,GAAe,OAAO,MAAP,CAAc;AAC3B,aAAK,CADsB;AAE3B,aAAK,GAFsB;AAG3B,cAAM,CAHqB;AAI3B,aAAK;AACH,iBAAO,aADJ,EAC4B;AAC/B,mBAAS,UAFN,CAE4B;AAF5B;AAJsB,OAAd,EAQZ,KAAK,EAAL,CAAQ,OARI,EAQK,OARL,CAAf;;AAUA;AACA,WAAK,OAAL,CAAa,GAAb,GAAmB,WAAW,KAAK,OAAL,CAAa,GAAxB,EAA6B,EAA7B,CAAnB;AACA,WAAK,OAAL,CAAa,GAAb,GAAmB,WAAW,KAAK,OAAL,CAAa,GAAxB,EAA6B,EAA7B,CAAnB;AACA,WAAK,OAAL,CAAa,IAAb,GAAoB,WAAW,KAAK,OAAL,CAAa,IAAxB,EAA8B,EAA9B,CAApB;;AAEA;AACA,WAAK,QAAL,GAAgB,KAAhB;;AAEA;AACA,WAAK,QAAL,GAAgB,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,KAAK,EAAL,CAAQ,gBAAR,CAAyB,mBAAzB,CAA3B,CAAhB;AACA,WAAK,UAAL,GAAkB,EAAlB;;AAEA;AACA,WAAK,QAAL;AACA,WAAK,cAAL;;AAEA;AACA,WAAK,UAAL;AACD;;AAED;;;;;AAzCS;AAAA;AAAA,uCA4CQ;AACf,YAAM,OAAO,IAAb;AACA,eAAO,KAAK,QAAL,CAAc,MAAd,CAAqB,UAAC,QAAD,EAAW,OAAX;AAAA,iBACvB,QADuB,mDAC+B,QAAQ,IADvC,sBAEtB,KAAK,OAAL,CAAa,GAAb,CAAiB,OAFK;AAAA,SAArB,EAGK,EAHL,CAAP;AAKD;;AAED;;;;AArDS;AAAA;AAAA,mCAwDI,SAxDJ,EAwDe;AACtB,YAAM,OAAO,IAAb;AACA,kBAAU,gBAAV,CAA2B,sBAA3B,EAAmD,OAAnD,CAA2D,UAAC,EAAD,EAAQ;AACjE,aAAG,cAAH,GAAoB,KAAK,EAAL,CAAQ,aAAR,iBAAoC,GAAG,OAAH,CAAW,GAA/C,OAApB;AACA,eAAK,UAAL,CAAgB,IAAhB,CAAqB,EAArB;AACD,SAHD;AAID;;AAED;;;;AAhES;AAAA;AAAA,uCAmEQ;AACf,YAAM,OAAO,IAAb;AACA,aAAK,UAAL,CAAgB,OAAhB,CAAwB,UAAC,EAAD,EAAQ;AAC9B;AACA,cAAM,QAAQ,WAAW,GAAG,cAAH,CAAkB,KAA7B,EAAoC,EAApC,CAAd;AACA,cAAM,UAAU,KAAK,cAAL,CAAoB,KAApB,CAAhB;AACA,aAAG,KAAH,CAAS,IAAT,GAAmB,OAAnB;AACA,aAAG,SAAH,GAAe,GAAG,SAAH,CAAa,OAAb,CAAqB,WAArB,EAAkC,KAAlC,CAAf;AACD,SAND;AAOD;AA5EQ;AAAA;AAAA,qCA8EM,GA9EN,EA8EW;AAClB,YAAM,QAAQ,KAAK,OAAL,CAAa,GAAb,GAAmB,KAAK,OAAL,CAAa,GAA9C;AACA,eAAQ,MAAM,KAAP,GAAgB,GAAvB;AACD;;AAED;;;;AAnFS;AAAA;AAAA,iCAsFE;AACT;AACA,YAAM,QAAQ,SAAS,aAAT,CAAuB,KAAvB,CAAd;AACA,cAAM,SAAN,GAAkB,oBAAlB;AACA,cAAM,SAAN,GAAkB,KAAK,OAAL,CAAa,GAAb,CAAiB,KAAnC;AACA,aAAK,EAAL,CAAQ,WAAR,CAAoB,KAApB;;AAEA;AACA,cAAM,SAAN,GAAkB,MAAM,SAAN,CAAgB,OAAhB,CAAwB,cAAxB,EAAwC,KAAK,cAAL,EAAxC,CAAlB;AACA,aAAK,YAAL,CAAkB,KAAlB;;AAEA;AACA,aAAK,EAAL,CAAQ,WAAR,CAAoB,KAApB;AACD;;AAED;;;;AArGS;AAAA;AAAA,mCAwGI;AAAA;;AACX,aAAK,EAAL,CAAQ,gBAAR,CAAyB,WAAzB,EAAsC;AAAA,iBAAO,MAAK,WAAL,CAAiB,GAAjB,CAAP;AAAA,SAAtC;AACA,iBAAS,IAAT,CAAc,gBAAd,CAA+B,SAA/B,EAA0C;AAAA,iBAAO,MAAK,SAAL,CAAe,GAAf,CAAP;AAAA,SAA1C;AACA,iBAAS,IAAT,CAAc,gBAAd,CAA+B,WAA/B,EAA4C;AAAA,iBAAO,MAAK,WAAL,CAAiB,GAAjB,CAAP;AAAA,SAA5C;AACD;;AAED;;;;AA9GS;AAAA;AAAA,kCAiHG,GAjHH,EAiHQ;AACf,iBAAS,QAAQ,GAAR,CAAY,yBAAZ,EAAuC,GAAvC,CAAT;AACA,YAAM,QAAQ,KAAK,UAAL,CAAgB,OAAhB,CAAwB,IAAI,MAA5B,CAAd;AACA;AACA,YAAI,QAAQ,CAAZ,EAAe;AACb,iBAAO,KAAP;AACD;;AAED,aAAK,QAAL,GAAgB;AACd,qBAAW,KADG;AAEd,mBAAS,KAAK,UAAL,CAAgB,KAAhB,CAFK;AAGd,kBAAQ,IAAI;AAHE,SAAhB;AAKA,eAAO,IAAP;AACD;;AAED;;;;AAjIS;AAAA;AAAA,kCAoIG;AACV,iBAAS,QAAQ,GAAR,CAAY,uBAAZ,CAAT;AACA,aAAK,QAAL,GAAgB,KAAhB;AACD;AAvIQ;AAAA;AAAA,kCAyIG,GAzIH,EAyIQ;AACf,iBAAS,QAAQ,GAAR,CAAY,yBAAZ,CAAT;AACA,gBAAQ,GAAR;AACA,YAAI,KAAK,QAAL,IAAiB,KAAK,QAAL,CAAc,SAAd,GAA0B,CAAC,CAAhD,EAAmD;AACjD,cAAM,UAAU,IAAI,OAApB;AACA,kBAAQ,GAAR,CAAY,KAAK,QAAL,CAAc,MAA1B,EAAkC,IAAI,OAAtC;AACA,eAAK,QAAL,CAAc,OAAd,CAAsB,KAAtB,CAA4B,IAA5B,GAAsC,OAAtC;AACD;AACF;AAjJQ;;AAAA;AAAA;;AAoJX,MAAM,OAAO,SAAP,IAAO,CAAC,GAAD,EAAS;AACpB,QAAI,OAAJ,CAAY,UAAC,EAAD,EAAQ;AAClB,aAAO,IAAI,WAAJ,CAAgB,EAAhB,CAAP;AACD,KAFD;AAGD,GAJD;;AAOA,SAAO,WAAP,GAAqB;AACnB;AADmB,GAArB;AAGD,CA9JD,EA8JG,MA9JH","file":"multihandle.js","sourcesContent":["((window) => {\r\n  const debug = true;\r\n\r\n  class MultiHandle {\r\n    constructor(el, options = {}) {\r\n      this.el = el;\r\n\r\n      // removing the \"loading\" state - show component\r\n      this.el.className = el.className.replace(/multihandle--loading/g, '');\r\n\r\n      // default options\r\n      this.options = Object.assign({\r\n        min: 0,\r\n        max: 100,\r\n        step: 1,\r\n        tpl: {\r\n          track: '${handlers}',          // must have a single root element!\r\n          handler: '${value}'            // must have a single root element!\r\n        }\r\n      }, this.el.dataset, options);\r\n\r\n      // normalize values\r\n      this.options.min = parseFloat(this.options.min, 10);\r\n      this.options.max = parseFloat(this.options.max, 10);\r\n      this.options.step = parseFloat(this.options.step, 10);\r\n\r\n      // are we dragging something?\r\n      this.dragging = false;\r\n\r\n      // reference to the original handlers, converted to an array\r\n      this.handlers = Array.prototype.slice.call(this.el.querySelectorAll('input[type=range]'));\r\n      this.handlerEls = [];\r\n\r\n      // creating the component\r\n      this.buildDOM();\r\n      this.updateHandlers();\r\n\r\n      // binding events to the component\r\n      this.bindEvents();\r\n    }\r\n\r\n    /**\r\n     * Creating DOM strings for the handlers\r\n     */\r\n    createHandlers() {\r\n      const self = this;\r\n      return this.handlers.reduce((previous, current) => (\r\n        `${previous}<div class=\"multihandle__handle\" data-for=\"${current.name}\">\r\n          ${self.options.tpl.handler}\r\n        </div>`), ''\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Finding the handlers in the existing DOM\r\n     */\r\n    findHandlers(container) {\r\n      const self = this;\r\n      container.querySelectorAll('.multihandle__handle').forEach((el) => {\r\n        el.inputReference = self.el.querySelector(`input[name=${el.dataset.for}]`);\r\n        self.handlerEls.push(el);\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Update the handlers to reflect the inputs' state\r\n     */\r\n    updateHandlers() {\r\n      const self = this;\r\n      self.handlerEls.forEach((el) => {\r\n        // console.log(self.valueToPercent(parseFloat(el.inputReference.value, 10));\r\n        const value = parseFloat(el.inputReference.value, 10);\r\n        const percent = self.valueToPercent(value);\r\n        el.style.left = `${percent}%`;\r\n        el.innerHTML = el.innerHTML.replace(/\\${value}/, value);\r\n      });\r\n    }\r\n\r\n    valueToPercent(val) {\r\n      const scale = this.options.max - this.options.min;\r\n      return (val / scale) * 100;\r\n    }\r\n\r\n    /**\r\n     * Creating the track and the handlers\r\n     */\r\n    buildDOM() {\r\n      // creating the track element\r\n      const track = document.createElement('div');\r\n      track.className = 'multihandle__track';\r\n      track.innerHTML = this.options.tpl.track;\r\n      this.el.appendChild(track);\r\n\r\n      // putting the handlers on the track\r\n      track.innerHTML = track.innerHTML.replace(/\\${handlers}/, this.createHandlers());\r\n      this.findHandlers(track);\r\n\r\n      // putting the whole component in the container\r\n      this.el.appendChild(track);\r\n    }\r\n\r\n    /**\r\n     * Adding eventlisteners\r\n     */\r\n    bindEvents() {\r\n      this.el.addEventListener('mousedown', evt => this.onMouseDown(evt));\r\n      document.body.addEventListener('mouseup', evt => this.onMouseUp(evt));\r\n      document.body.addEventListener('mousemove', evt => this.onMouseMove(evt));\r\n    }\r\n\r\n    /**\r\n     * We may start dragging one of the handlers\r\n     */\r\n    onMouseDown(evt) {\r\n      debug && console.log('MultiHandle:onMouseDown', evt);\r\n      const found = this.handlerEls.indexOf(evt.target);\r\n      // click triggered on the track, not on one of the handlers\r\n      if (found < 0) {\r\n        return false;\r\n      }\r\n\r\n      this.dragging = {\r\n        handlerIx: found,\r\n        handler: this.handlerEls[found],\r\n        startX: evt.clientX\r\n      };\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * Dragging stopped\r\n     */\r\n    onMouseUp() {\r\n      debug && console.log('MultiHandle:onMouseUp');\r\n      this.dragging = false;\r\n    }\r\n\r\n    onMouseMove(evt) {\r\n      debug && console.log('MultiHandle:onMouseMove');\r\n      console.log();\r\n      if (this.dragging && this.dragging.handlerIx > -1) {\r\n        const newLeft = evt.clientX;\r\n        console.log(this.dragging.startX, evt.clientX);\r\n        this.dragging.handler.style.left = `${newLeft}px`;\r\n      }\r\n    }\r\n  }\r\n\r\n  const init = (els) => {\r\n    els.forEach((el) => {\r\n      return new MultiHandle(el);\r\n    });\r\n  };\r\n\r\n\r\n  window.multihandle = {\r\n    init\r\n  };\r\n})(window);\r\n"]}